{% extends 'dashboard/dashboard_base.html' %}
{% load static %}
{% block title %}
Tes Urine Deteksi Dini
{% endblock %}
{% block content %}
<div class="breadcrumb">
  <div class="row">
    <h3 class="heading mb-2">Tes Urine Deteksi Dini</h3>
    <span class="mb-0">
      <span class="text-muted fw-light">Kegiatan /</span>
      <span class="ms-1 fw-medium">Tes Urine Deteksi Dini</span>
    </span>
  </div>
</div>

<section id="__data">
    <div class="card">
        <div class="card-body">
          <div id="headline" class="mb-3">
            <h3 class="text-center">
              KEGIATAN TES URINE DETEKSI DINI PEMBERDAYAAN MASYARAKAT<br />
              <span id="currentYear"></span>
            </h3>
            <hr />
          </div>

            <div class="action-button">
                <div class="d-flex justify-content-end mb-3 gap-2">
                    <button class="btn btn-success" onclick="handleExport()"><i
                            class="fas fa-file-export me-2"></i>Ekspor Data</button>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createModal"><i
                            class="fas fa-plus me-2"></i>Tambah Data</button>
                </div>
            </div>

            <div class="table-responsive">
              {% include 'psm/tes_urine_deteksi_dini/table.html' %}
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block js_tambahan %}
<script src="{% static 'assets/dashboard/vendor/libs/jquery-repeater/jquery-repeater.js' %}"></script>
<script src="{% static 'assets/dashboard/js/bawaan/forms-extras.js' %}"></script>
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script type="text/javascript" src="https://oss.sheetjs.com/sheetjs/xlsx.full.min.js"></script>

<script>
   document.addEventListener('alpine:init', function() {
        Alpine.data("create", () => ({
            id: 0,
            tanggal_awal: '',
            tanggal_akhir: '',
            jumlah_hari_pelaksanaan: "0 hari",
            kendala: '',
            tindak_lanjut: '',
            state: {
                kendala : {
                    show_keterangan: false,
                },
                tindak_lanjut : {
                    yes_show_keterangan: false,
                    no_show_container: false,
                    no_show_container_lainnya: false,
                },
            },
        }));
        
        Alpine.store("edit", {
            data: {
                id: 0,
                tanggal_awal: '',
                tanggal_akhir: '',
                jumlah_hari_pelaksanaan: "0 hari",
                jumlah_peserta: 0,
                tujuan: '',
                kendala: '',
                kesimpulan: '',
                tindak_lanjut: '',
                satker: 0,
                satker_target: 0,
            },
            state: {
                kendala : {
                    show_keterangan: false,
                },
                tindak_lanjut : {
                    yes_show_keterangan: false,
                    no_show_container: false,
                    no_show_container_lainnya: false,
                },
            },
            updateData(data) {
                this.data = data;
            },
            updateState(state) {
                this.state = state;
            },
        });
    });
</script>

<script>
  let table;
  var id_edit_global;
  const TIPE_kegiatan = {{ user.profile.satker.level }}
  const { createApp, ref, onMounted, computed } = Vue;

  createApp({
    setup() {
      let rakernisData = ref(null);
      let satkerLevel = parseInt('{{ user.profile.satker.level }}');
      let perPage = ref(10);
      let currentPage = ref(1);
      let searchField = ref(null);
      let filteredPage = ref(null);

      const totalPage = computed(() => {
        if (rakernisData.value) {
          return Math.ceil(rakernisData.value.length / perPage.value);
        }
        else return 0;
      });

      const pagedData = computed(() => {
        if (filteredPage.value) {
          d = filteredPage.value.slice((currentPage.value - 1) * perPage.value, (currentPage.value) * perPage.value);
          return d;
        }
        else return [];
      });

      function searchData(e) {
        filteredPage.value = rakernisData.value.filter((data) => {
            idx = String(data.satker.toUpperCase());
            nama_lingkungan = String(data.nama_lingkungan.toUpperCase());
            daftar_nama_peserta = String(data.daftar_nama_peserta.toUpperCase());
            tindak_lanjut = String(data.tindak_lanjut.toUpperCase());

            bool1 = idx.indexOf(searchField.value.toUpperCase()) > -1;
            bool2 = nama_lingkungan.indexOf(searchField.value.toUpperCase()) > -1;
            bool3 = daftar_nama_peserta.indexOf(searchField.value.toUpperCase()) > -1;
            bool4 = tindak_lanjut.indexOf(searchField.value.toUpperCase()) > -1;

            return bool1 || bool2 || bool3 || bool4;
        });
      };

      function hideableButton(status, satkerLevel, type) {
        if (type == 'kirim') {
          return satkerLevel != 2 && ((satkerLevel == 0 && status < 2) || (satkerLevel == 1 && status < 1));
        } else if (type == 'edit') {
          return satkerLevel == 2 || ((satkerLevel == 0 && status < 2) || (satkerLevel == 1 && status < 1));
        }
      }

      const apiURL = (satkerLevel == 1 ? '/kegiatan/api/v1/psm/tes_urine/get_data_bnnk/?format=datatables' : '/kegiatan/api/v1/psm/tes_urine/?format=datatables')
      
      function loadData() {
        tableContent = [];
        axios.get(apiURL).then(function (response) {
          data = response.data.data;
          
          for ([key, value] of Object.entries(data)) {
              // untuk satker tingkat BNNP

              baris = { 'class':'table-primary','hide_satker':false,'index': parseInt(key)+1,'satker': value.satker.nama_satker +'(' + value.data.length + ' kegiatan)',
                'tanggal':'','nama_lingkungan':'','pria':'','wanita':'','jumlah_peserta':'','daftar_nama_peserta':'','hasil_test_urine':'','tindak_lanjut':'','dokumentasi':''
                ,'aksi':'','status':'','level':'', 'type':'parent', 'id':value.id};
              tableContent.push(baris);
              console.log(value.data);
              
              // untuk detail dari satker BNNP
              for ([key2, value2] of Object.entries(value.data)) {
                console.log(value2);
                let formattedData = countHasilTest(value2.pegawai);
                baris = { 'class':'table-light','hide_satker':true,'index': (parseInt(key)+1) + '.' + (parseInt(key2)+1),'satker': value2.satker.nama_satker,
                'tanggal':value2.tanggal_awal+'-'+value2.tanggal_akhir,'nama_lingkungan':value2.nama_lingkungan,'pria':countMaleParticipants(value2.pegawai),'wanita':countFemaleParticipants(value2.pegawai),'jumlah_peserta':value2.pegawai.length,'daftar_nama_peserta':formatNamaAlamat(value2.pegawai),'hasil_test_urine':'Positi - '+formattedData.positif+' Negatif - '+formattedData.negatif+'','tindak_lanjut':value2.tindak_lanjut,'dokumentasi': value2.dokumentasi
                ,'aksi':'','status':value2.status,'level':value2.satker.level, 'type':'child', 'id':value2.id, 'kirim': hideableButton(value2.status, satkerLevel, 'kirim'), 'edit': hideableButton(value2.status, satkerLevel, 'edit'),};
                tableContent.push(baris);
              }

              // untuk mengecek
              if (value.detail !== undefined && value.detail.length>0) {
                // untuk satker bnnknya
                for ([key3,value3] of Object.entries(value.detail)) {
                  baris = { 'class':'table-secondary','hide_satker':false,'index': (parseInt(key)+1) + '.' + (parseInt(key2)+1) + '.' + (parseInt(key3)+1),'satker': value3.satker.nama_satker +'(' + value3.data.length + ' kegiatan)',
                  'tanggal':'','nama_lingkungan':'','pria':'','wanita':'','jumlah_peserta':'','daftar_nama_peserta':'','hasil_test_urine':'','tindak_lanjut':'','dokumentasi':''
                  ,'aksi':'','status':'','level':'', 'type':'parent',  'id':value3.id};
                  tableContent.push(baris);

                // untuk detail data satker bnnknya
                  for ([key4, value4] of Object.entries(value3.data)) {
                    let formattedData = countHasilTest(value4.pegawai);
                    baris = { 'class':'table-light','hide_satker':true,'index': (parseInt(key)+1) + '.' + (parseInt(key2)+1),'satker': value4.satker.nama_satker,
                    'tanggal':value4.tanggal_awal+'-'+value4.tanggal_akhir,'nama_lingkungan':value4.nama_lingkungan,'pria':countMaleParticipants(value4.pegawai),'wanita':countFemaleParticipants(value4.pegawai),'jumlah_peserta':value4.pegawai.length,'daftar_nama_peserta':formatNamaAlamat(value4.pegawai),'hasil_test_urine':'Positi - '+formattedData.positif+' Negatif - '+formattedData.negatif+'','tindak_lanjut':value4.tindak_lanjut,'dokumentasi':'/media/'+value4.dokumentasi
                    ,'aksi':'','status':value4.status,'level':value4.satker.level, 'type':'child', 'id':value4.id, 'kirim': hideableButton(value4.status, satkerLevel, 'kirim'), 'edit': hideableButton(value4.status, satkerLevel, 'edit'),};
                    tableContent.push(baris);
                  }
                }
              }
            }
          
          rakernisData.value = tableContent;
          filteredPage.value = rakernisData.value;
        });
      };

      // fungsi fill data untuk modal edit
      async function handleEditModal(id) {
        console.log(id);
        try {
          const response = await axios.get(`/kegiatan/api/v1/psm/tes_urine/${id}/get_detail_data_detail`);
          const data = response.data[0];
          id_edit_global = data.id

          $('#edit__satker').val(data.satker_id).trigger('change'); // Assuming 'satker' is a property in data
          $('#edit__tanggal_awal').val(data.tanggal_awal);
          $('#edit__tanggal_akhir').val(data.tanggal_akhir);
          $('#edit__satker_target').val(data.satker_target).trigger('change');
          $('#edit__nama_lingkungan').val(data.nama_lingkungan);
          $('#edit__tindak_lanjut').val(data.tindak_lanjut);

          $('[data-repeater-list="peserta-group-lama"]').children().remove();

          populateFormRepeater(data.peserta);

          $('#editData').modal('show');
        } catch (error) {
          showSwalGenericError();
          console.error('Terjadi kesalahan :', error);
        }
      }
        
      async function handleDelete(data){
        console.log(data);

        let id = data;

        Swal.fire({
            title: "Peringatan !",
            text: "Hapus data Kegiatan ?",
            icon: "warning",
            showDenyButton: true,
            confirmButtonText: "Hapus !",
            denyButtonText: "Batal"
        }).then((result) => {
            if (result.isConfirmed) {
                axios.delete('/kegiatan/api/v1/psm/tes_urine/'+id+'/delete_kegiatan_peserta/')
                    .then(function (response) {
                        Swal.fire({
                            icon: "success",
                            title: "Delete data berhasil !",
                            text: "Data terhapus !",
                            showConfirmButton: false,
                            timer: 1000
                        }).then((result) => {
                            if (result.dismiss === Swal.DismissReason.timer) {
                                location.reload();
                            }
                        });
                    })
                    .catch(function (error) {
                        Swal.fire({
                            icon: "error",
                            title: "Terjadi kesalahan !",
                            text: "API bermasalah !",
                        });
                });

            } else if (result.isDenied) {
            }
        });
      }

      async function handleDownload(data){
        var currentURLOrigin = window.location.origin;
        const combinedData = `${currentURLOrigin}${data}`;
        window.location.href = combinedData;
      } 

      // fungsi ubah status post data
      async function handleSend(data){
        console.log(data);
        Swal.fire({
            title: "Peringatan !",
            text: "Kirim kegiatan ?",
            icon: "warning",
            showDenyButton: true,
            confirmButtonText: "Kirim !",
            denyButtonText: "Batal"
        }).then((result) => {
            if (result.isConfirmed) {
                axios.post('/kegiatan/api/v1/psm/tes_urine/kirim_kegiatan/', { id_: data })
                    .then(function (response) {
                        Swal.fire({
                            icon: "success",
                            title: "Kirim data berhasil !",
                            text: "Data Terkirim !",
                            showConfirmButton: false,
                            timer: 1000
                        }).then((result) => {
                            if (result.dismiss === Swal.DismissReason.timer) {
                                location.reload();
                            }
                        });
                    })
                    .catch(function (error) {
                        Swal.fire({
                            icon: "error",
                            title: "Terjadi kesalahan !",
                            text: "API bermasalah !",
                        });
                });

            } else if (result.isDenied) {
            }
        });
      }

      onMounted(() => {
        loadData();
      });
      return {
        rakernisData,
        satkerLevel,
        loadData,
        handleEditModal,
        handleDelete,
        handleSend,
        handleDownload,
        totalPage,
        perPage,
        currentPage,
        pagedData,
        searchData,
        searchField
      }
    },
    delimiters: ['${', '}']
  }).mount('#app');
</script>


<!-- helper -->
<script>
  function handlePost(e) {
    e.preventDefault();

    var formData = {
        satker: $('#create__satker').val(),
        tanggal_awal: $('#create__tanggal_awal').val(),
        tanggal_akhir: $('#create__tanggal_akhir').val(),
        satker_target: $('#create__satker_target').val(),
        tindak_lanjut: $('#create__tindak_lanjut').val(),
        dokumentasi: $('#create__dokumentasi')[0].files[0],
        peserta: []
      };

      $('.form-repeater.create [data-repeater-item]').each(function(index, element) {
          formData.peserta.push({
              nama: $(element).find('[id^="form-repeater"]').eq(0).val(),
              alamat: $(element).find('[id^="form-repeater"]').eq(1).val(),
              gender: $(element).find('[id^="form-repeater"]').eq(2).val(),
              status: $(element).find('[id^="form-repeater"]').eq(3).val()
          });
      });

      if (checkDataCompleteness(formData.peserta) == 2) {
        Swal.fire({
          title: "Simpan data ?",
          icon: "warning",
          showDenyButton: true,
          confirmButtonText: "Simpan",
          denyButtonText: `Batal`
        }).then((result) => {
          /* Read more about isConfirmed, isDenied below */
          if (result.isConfirmed) {
            savedata();
          } else if (result.isDenied) {
          }
        });
      }else if (checkDataCompleteness(formData.peserta) == 0) {
        Swal.fire({
          title: "Terjadi Kesalahan !",
          text: "Data Peserta kosong!",
          icon: "error"
        });
      } else {
        Swal.fire({
          title: "Terjadi Kesalahan !",
          text: "Data Peserta tidak lengkap!",
          icon: "error"
        });
      }

  };

  function savedata() {
      var url = "/kegiatan/api/v1/psm/tes_urine/"

      var formData = new FormData();
      formData.append('satker', $('#create__satker').val());
      formData.append('tanggal_awal', $('#create__tanggal_awal').val());
      formData.append('tanggal_akhir', $('#create__tanggal_akhir').val());
      formData.append('satker_target', $('#create__satker_target').val());
      formData.append('nama_lingkungan', $('#create__nama_lingkungan').val());
      formData.append('tindak_lanjut', $('#create__tindak_lanjut').val());
      formData.append('dokumentasi', $('#create__dokumentasi')[0].files[0]);

      var pesertaArray = [];
      $('.form-repeater.create [data-repeater-item]').each(function(index, element) {
          pesertaArray.push({
              nama: $(element).find('[id^="form-repeater"]').eq(0).val(),
              alamat: $(element).find('[id^="form-repeater"]').eq(1).val(),
              gender: $(element).find('[id^="form-repeater"]').eq(2).val(),
              status: $(element).find('[id^="form-repeater"]').eq(3).val()
          });
      });

      formData.append('peserta_array', JSON.stringify(pesertaArray));

      axios.post(url, formData, {
            headers: {
                'Content-Type': 'multipart/form-data'
            }
        })
        .then(function (response) {
            swal.fire({
                title: "Berhasil menyimpan kegiatan !",
                icon : "success",
                timer: 1500,
                timerProgressBar: true,
                allowOutsideClick: false,
                allowEscapeKey: false,
            }).then((result) => {
              window.location.reload();
            });
        })
        .catch(function (error) {
            console.error(error);
        });
    };

  $('#editButton').click(function() {
    var url = "/kegiatan/api/v1/psm/tes_urine_crud/"+id_edit_global+"/"

    var formData = new FormData();

    formData.append('satker', $('#edit__satker').val());
    formData.append('tanggal_awal', $('#edit__tanggal_awal').val());
    formData.append('tanggal_akhir', $('#edit__tanggal_akhir').val());
    formData.append('satker_target', $('#edit__satker_target').val());
    formData.append('nama_lingkungan', $('#edit__nama_lingkungan').val());
    formData.append('tindak_lanjut', $('#edit__tindak_lanjut').val());
    // Check if file is selected
    var dokumentasiFile = $('#edit__dokumentasi')[0].files[0];
    if (dokumentasiFile) {
        formData.append('dokumentasi', dokumentasiFile);
    }


    var pesertaArray = [];
    $('.form-repeater.edit [data-repeater-item]').each(function(index, element) {
      pesertaArray.push({
            nama: $(element).find('[id^="form-repeater"]').eq(0).val(),
            alamat: $(element).find('[id^="form-repeater"]').eq(1).val(),
            gender: $(element).find('[id^="form-repeater"]').eq(2).val(),
            status: $(element).find('[id^="form-repeater"]').eq(3).val()
        });
    });
    formData.append('pesertaArray', JSON.stringify(pesertaArray));

    var peserta_lamaArray = [];
    $('.form-repeater-lama [data-repeater-item-lama]').each(function(index, element) {
      peserta_lamaArray.push({
            nama: $(element).find('[id^="form-repeater-edit-lama"]').eq(0).val(),
            alamat: $(element).find('[id^="form-repeater-edit-lama"]').eq(1).val(),
            gender: $(element).find('[id^="form-repeater-edit-lama"]').eq(2).val(),
            status: $(element).find('[id^="form-repeater-edit-lama"]').eq(3).val()
        });
    });
    formData.append('peserta_lamaArray', JSON.stringify(peserta_lamaArray));

    const pesertaCompleteness = checkDataCompleteness(pesertaArray);
    const pesertaLamaCompleteness = checkDataCompleteness(peserta_lamaArray);

    if (pesertaCompleteness === 2 && pesertaLamaCompleteness === 2) {
        showConfirmationDialog(formData, url);
    } else if (pesertaLamaCompleteness === 0) {
        showErrorDialog("Data Peserta kosong!");
    } else if (pesertaCompleteness === 1 || pesertaLamaCompleteness === 1) {
        showErrorDialog("Data Peserta tidak lengkap!");
    }else{
        showConfirmationDialog(formData, url);
    }
  });

  async function handleExport(){
    axios.post('/kegiatan/api/v1/psm/tes_urine/export_data/')
        .then(function (response) {
            
            const data = response.data;

            window.location.href = data.file_path;
        })
        .catch(function (error) {
            Swal.fire({
                icon: "error",
                title: "Terjadi kesalahan !",
                text: "API bermasalah !",
            });
    });
  }

  async function handleDate(event, target) {
    const currentDate = moment().format('YYYY-MM-DD');
    const valueDate = $(event.target).val();
    (valueDate === currentDate ? $(`#${target}tanggal_akhir`).attr('disabled', true) : $(`#${target}tanggal_akhir`).attr('disabled', false));
  }

  function countMaleParticipants(data) {
      let count = 0;
      data.forEach(function(row) {
          if (row.jenis_kelamin === "Laki-Laki") {
              count++;
          }
      });
      return count;
  }

  function countFemaleParticipants(data) {
      let count = 0;
      data.forEach(function(row) {
          if (row.jenis_kelamin === "Perempuan") {
              count++;
          }
      });
      return count;
  }

  function formatNamaAlamat(data) {
    let formattedData = [];
    data.forEach(function(row) {
        let formattedString = row.nama_peserta + " - " + row.alamat;
        formattedData.push(formattedString);
    });
    // Join the elements of the array with ", "
    let result = formattedData.join(", ");
    return result;
}

  function countHasilTest(data) {
    let countPositif = 0;
    let countNegatif = 0;

    data.forEach(function(row) {
        if (row.hasil_test === "Positif") {
            countPositif++;
        } else if (row.hasil_test === "Negatif") {
            countNegatif++;
        }
    });

    return {
        positif: countPositif,
        negatif: countNegatif
    };
  }

  function populateFormRepeater(data) {
      data.forEach(function(item) {
          var $repeaterItem = $('<div data-repeater-item-lama></div>');

          $repeaterItem.append('<div class="row">' +
              '<div class="mb-3 col-lg-5 col-sm-10 mb-0">' +
              '<label class="form-label" for="form-repeater-edit-lama-1-1">Nama </label>' +
              '<input type="text" class="form-control" id="form-repeater-edit-lama-1-1" placeholder="Nama Peserta" value="' + item.nama_peserta + '"/>' +
              '</div>' +
              '<div class="mb-3 col-lg-5 col-sm-10 mb-0">' +
              '<label class="form-label" for="form-repeater-edit-lama-1-2">Alamat</label>' +
              '<input type="text" class="form-control" id="form-repeater-edit-lama-1-2" placeholder="Alamat Peserta" value="' + item.alamat + '"/>' +
              '</div>' +
              '<div class="mb-3 col-lg-5 col-sm-10 mb-0">' +
              '<label class="form-label mb-3 d-block" for="form-repeater-edit-lama-1-4">Status</label>' +
              '<select class="form-select" id="form-repeater-edit-lama-1-4" name="status">' +
              '<option value="" disabled>Pilih Status</option>' +
              '<option value="P"' + (item.hasil_test === 'Positif' ? ' selected' : '') + '>Positif</option>' +
              '<option value="N"' + (item.hasil_test === 'Negatif' ? ' selected' : '') + '>Negatif</option>' +
              '</select>' +
              '</div>' +
              '<div class="mb-3 col-lg-5 col-sm-10 mb-0">' +
              '<label class="form-label mb-3 d-block" for="form-repeater-edit-lama-1-3">Jenis Kelamin</label>' +
              '<select class="form-select" id="form-repeater-edit-lama-1-3" name="jenis_kelamin">' +
              '<option value="" disabled>Pilih Jenis Kelamin</option>' +
              '<option value="L"' + (item.jenis_kelamin === 'Laki-Laki' ? ' selected' : '') + '>Laki-laki</option>' +
              '<option value="P"' + (item.jenis_kelamin === 'Perempuan' ? ' selected' : '') + '>Perempuan</option>' +
              '</select>' +
              '</div>' +
              '<div class="mb-3 col-lg-12 col-xl-2 col-12 d-flex align-items-center mb-0">' +
              '<button class="btn btn-label-danger mt-4 hapus_lama" data-repeater-delete type="button" value="Delete">' +
              '<i class="ti ti-x ti-xs me-1"></i>' +
              '<span class="align-middle">Hapus</span>' +
              '</button>' +
              '</div>' +
              '</div>' +
              '<hr class="mx-n4">');

          $('[data-repeater-list="peserta-group-lama"]').append($repeaterItem);
      });
  }

  function removeEmptyObjects(array) {
      return array.filter(function(obj) {
          return obj.nama !== "" || obj.alamat !== "" || obj.gender !== null || obj.status !== null;
      });
  }

  function checkDataCompleteness(dataArray) {
      var isDataComplete = true;
      var allNull = true;
      var someNull = false;
      
      $.each(dataArray, function(index, obj) {
          if (!Object.values(obj).some(value => value !== null && value !== '')) {
              allNull = true;
          } else {
              allNull = false;
              if (Object.values(obj).some(value => value === null || value === '')) {
                  someNull = true;
                  return false; // Break the loop early if any null value is found
              }
          }
      });

    if (allNull) {
      return 0;
    } else if (someNull) {
        return 1;
    } else {
        return 2;
    }
  }

  function showConfirmationDialog(formData, url) {
      Swal.fire({
          title: "Update data ?",
          icon: "warning",
          showDenyButton: true,
          confirmButtonText: "Simpan",
          denyButtonText: `Batal`
      }).then((result) => {
          if (result.isConfirmed) {
              sendData(formData, url);
          }
      });
  }

  function sendData(formData, url) {
      axios.put(url, formData, {
              headers: {
                  'Content-Type': 'multipart/form-data'
              }
          })
          .then(function(response) {
              Swal.fire({
                  title: "Berhasil menyimpan kegiatan !",
                  icon: "success",
                  timer: 1500,
                  timerProgressBar: true,
                  allowOutsideClick: false,
                  allowEscapeKey: false,
            }).then((result) => {
              window.location.reload();
            });
          })
          .catch(function(error) {
              console.error(error);
          });
  }

  function showErrorDialog(text) {
      Swal.fire({
          title: "Terjadi Kesalahan !",
          text: text,
          icon: "error"
      });
  }

  function addCell(tr, content, colSpan = 2) {
    let td = document.createElement('th');

    td.colSpan = colSpan;
    td.textContent = content;

    tr.appendChild(td);
  }

  function hideableButton(status, satkerLevel, type) {
    if (type == 'kirim') {
      return satkerLevel != 2 && ((satkerLevel == 0 && status < 2) || (satkerLevel == 1 && status < 1));
    } else if (type == 'edit') {
      return satkerLevel == 2 || ((satkerLevel == 0 && status < 2) || (satkerLevel == 1 && status < 1));
    }
  }
</script>

{% endblock %}

{% block modal_tambahan %}
{% include 'psm/tes_urine_deteksi_dini/modals/create.html' %}
{% include 'psm/tes_urine_deteksi_dini/modals/edit.html' %}
{% include 'psm/tes_urine_deteksi_dini/modals/lihat.html' %}
{% endblock %}